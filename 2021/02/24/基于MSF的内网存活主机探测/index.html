
<!DOCTYPE html>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1.0, user-scalable=no">
  <meta name="theme-color" content="#202020">
  <meta http-equiv="x-ua-compatible" content="ie=edge">
  <script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" async></script>
  
  
    <meta name="keywords" content="渗透测试,Metasploit,内网渗透,">
  

  
    <meta name="description" content="d2VsY29tZSB0byBteSBibG9n">
  
  
  
  <link rel="icon" type="image/x-icon" href="/1.jpg">
  
  <title>基于MSF的内网存活主机探测 [ Mi1k7ea ]</title>
  
    <!-- stylesheets list from config.yml -->
    
      <link rel="stylesheet" href="//cdn.bootcss.com/pure/1.0.0/pure-min.css">
    
      <link rel="stylesheet" href="/css/xoxo.css">
    
  
</head>


<body>
  <div class="nav-container">
    <nav class="home-menu pure-menu pure-menu-horizontal">
  <a class="pure-menu-heading" href="/">
    
    <span class="title" style="text-transform:none">Mi1k7ea</span>
  </a>

  <ul class="pure-menu-list clearfix">
      
          
            
              <li class="pure-menu-item"><a href="/archives" class="pure-menu-link">归档</a></li>
            
          
      
          
            
              <li class="pure-menu-item"><a href="/about" class="pure-menu-link">关于</a></li>
            
          
      
  </ul>
   
</nav>

  </div>

  <div class="container" id="content-outer">
    <div class="inner" id="content-inner">
      <div class="post-container">
  <article class="post" id="post">
    <header class="post-header text-center">
      <h1 class="title">
        基于MSF的内网存活主机探测
      </h1>
      <span>
        
        <time class="time" datetime="2021-02-24T13:28:04.000Z">
        2021-02-24
      </time>
        
      </span>
      <span class="slash">/</span>
      <span class="post-meta">
      <span class="post-tags">
        <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Metasploit/">Metasploit</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/内网渗透/">内网渗透</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/渗透测试/">渗透测试</a></li></ul>
      </span>
    </span>
      <!--<span class="slash">/</span>
      <span class="read">
      <span id="busuanzi_value_page_pv"></span> 点击
    </span>
      <span class="slash">/</span>-->
    </header>

    <div class="post-content">
      <h2 id="0x00-前言"><a href="#0x00-前言" class="headerlink" title="0x00 前言"></a>0x00 前言</h2><p>参考Micro8系列第二十三课：<a href="https://micro8.gitbook.io/micro8/contents-1/21-30/22-ji-yu-smb-fa-xian-nei-wang-cun-huo-zhu-ji" target="_blank" rel="noopener">https://micro8.gitbook.io/micro8/contents-1/21-30/22-ji-yu-smb-fa-xian-nei-wang-cun-huo-zhu-ji</a></p>
<p>参考Micro8系列第二十四课：<a href="https://micro8.gitbook.io/micro8/contents-1/21-30/24-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-er-ji" target="_blank" rel="noopener">https://micro8.gitbook.io/micro8/contents-1/21-30/24-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-er-ji</a></p>
<p>参考Micro8系列第二十五课：<a href="https://micro8.gitbook.io/micro8/contents-1/21-30/25-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-san-ji" target="_blank" rel="noopener">https://micro8.gitbook.io/micro8/contents-1/21-30/25-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-san-ji</a></p>
<p>参考Micro8系列第二十六课：<a href="https://micro8.gitbook.io/micro8/contents-1/21-30/26-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-si-ji" target="_blank" rel="noopener">https://micro8.gitbook.io/micro8/contents-1/21-30/26-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-si-ji</a></p>
<p>参考Micro8系列第二十七课：<a href="https://micro8.gitbook.io/micro8/contents-1/21-30/27-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-wu-ji" target="_blank" rel="noopener">https://micro8.gitbook.io/micro8/contents-1/21-30/27-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-wu-ji</a></p>
<p>参考Micro8系列第二十八课：<a href="https://micro8.gitbook.io/micro8/contents-1/21-30/28-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-liu-ji#er-shi-ba-ji-yu-windowsgatherenumdomain-fa-xian-yu-zhong-cun-huo-zhu-ji" target="_blank" rel="noopener">https://micro8.gitbook.io/micro8/contents-1/21-30/28-ji-yu-msf-fa-xian-nei-wang-cun-huo-zhu-ji-di-liu-ji#er-shi-ba-ji-yu-windowsgatherenumdomain-fa-xian-yu-zhong-cun-huo-zhu-ji</a></p>
<h2 id="0x01-search支持type类型搜索"><a href="#0x01-search支持type类型搜索" class="headerlink" title="0x01 search支持type类型搜索"></a>0x01 search支持type类型搜索</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; search scanner type:auxiliary</span><br><span class="line"></span><br><span class="line">Matching Modules</span><br><span class="line">================</span><br><span class="line"></span><br><span class="line">   #    Name                                                                     Disclosure Date  Rank    Check  Description</span><br><span class="line">   -    ----                                                                     ---------------  ----    -----  -----------</span><br><span class="line">   0    auxiliary/admin/appletv/appletv_display_image                                             normal  No     Apple TV Image Remote Control</span><br><span class="line">   1    auxiliary/admin/appletv/appletv_display_video                                             normal  No     Apple TV Video Remote Control</span><br><span class="line">   2    auxiliary/admin/smb/check_dir_file                                                        normal  No     SMB Scanner Check File/Directory Utility</span><br><span class="line">   3    auxiliary/admin/teradata/teradata_odbc_sql                               2018-03-29       normal  No     Teradata ODBC SQL Query Module</span><br><span class="line">...</span><br><span class="line">   588  auxiliary/scanner/wproxy/att_open_proxy                                  2017-08-31       normal  No     Open WAN-to-LAN proxy on AT&amp;T routers</span><br><span class="line">   589  auxiliary/scanner/wsdd/wsdd_query                                                         normal  No     WS-Discovery Information Discovery</span><br><span class="line">   590  auxiliary/scanner/x11/open_x11                                                            normal  No     X11 No-Auth Scanner</span><br></pre></td></tr></table></figure>
<h2 id="0x02-auxiliary-scanner-discovery-arp-sweep"><a href="#0x02-auxiliary-scanner-discovery-arp-sweep" class="headerlink" title="0x02 auxiliary/scanner/discovery/arp_sweep"></a>0x02 auxiliary/scanner/discovery/arp_sweep</h2><p>该模块是基于ARP协议来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">msf6 &gt; use auxiliary/scanner/discovery/arp_sweep</span><br><span class="line">msf6 auxiliary(scanner/discovery/arp_sweep) &gt; show options</span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/discovery/arp_sweep):</span><br><span class="line"></span><br><span class="line">   Name       Current Setting  Required  Description</span><br><span class="line">   ----       ---------------  --------  -----------</span><br><span class="line">   INTERFACE                   no        The name of the interface</span><br><span class="line">   RHOSTS                      yes       The target host(s), range CIDR identifier, or hosts file with syntax &apos;file:&lt;path&gt;&apos;</span><br><span class="line">   SHOST                       no        Source IP Address</span><br><span class="line">   SMAC                        no        Source MAC Address</span><br><span class="line">   THREADS    1                yes       The number of concurrent threads (max one per host)</span><br><span class="line">   TIMEOUT    5                yes       The number of seconds to wait for new data</span><br><span class="line"></span><br><span class="line">msf6 auxiliary(scanner/discovery/arp_sweep) &gt; set RHOSTS 172.17.0.0/24</span><br><span class="line">RHOSTS =&gt; 172.17.0.0/24</span><br><span class="line">msf6 auxiliary(scanner/discovery/arp_sweep) &gt; exploit</span><br><span class="line">SIOCSIFFLAGS: Operation not permitted</span><br><span class="line"></span><br><span class="line">[+] 172.17.0.1 appears to be up (UNKNOWN).</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x03-auxiliary-scanner-discovery-udp-sweep"><a href="#0x03-auxiliary-scanner-discovery-udp-sweep" class="headerlink" title="0x03 auxiliary/scanner/discovery/udp_sweep"></a>0x03 auxiliary/scanner/discovery/udp_sweep</h2><p>该模块是基于UDP协议来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/discovery/udp_sweep) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/discovery/udp_sweep): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">BATCHSIZE 256 yes The number of hosts to probe in each set</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/discovery/udp_sweep) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Sending 13 probes to 192.168.1.0‐&gt;192.168.1.255 (256 hosts)</span><br><span class="line">[*] Discovered DNS on 192.168.1.1:53 (ce2a8500000100010000000007564552  53494f4e0442494e440000100003c00c0010000300000001001a19737572656c7920796f7</span><br><span class="line">5206d757374206265206a6f6b696e67)</span><br><span class="line">[*] Discovered NetBIOS on 192.168.1.2:137 (JOHN‐PC:&lt;00&gt;:U :WORKGROUP:&lt;00&gt;:G :JOHN‐PC:&lt;20&gt;:U :WORKGROUP:&lt;1e&gt;:G :WORKGROUP:&lt;1d&gt;:U</span><br><span class="line">:__MSBROWSE__ &lt;01&gt;:G :4c:cc:6a:e3:51:27)</span><br><span class="line">[*] Discovered NetBIOS on 192.168.1.119:137 (WIN03X64:&lt;00&gt;:U :WIN03X64:&lt;20&gt;:U :WORKGROUP:&lt;00&gt;:G :WORKGROUP:&lt;1e&gt;:G :WIN03X64:&lt;03&gt;:U</span><br><span class="line">:ADMINISTRA TOR:&lt;03&gt;:U :WIN03X64:&lt;01&gt;:U :00:0c:29:85:d6:7d)</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x04-auxiliary-scanner-discovery-udp-probe"><a href="#0x04-auxiliary-scanner-discovery-udp-probe" class="headerlink" title="0x04 auxiliary/scanner/discovery/udp_probe"></a>0x04 auxiliary/scanner/discovery/udp_probe</h2><p>该模块是基于UDP协议来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/discovery/udp_probe) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/discovery/udp_probe): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">CHOST no The local client address</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/discovery/udp_probe) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] Discovered NetBIOS on 192.168.1.2:137 (JOHN‐PC:&lt;00&gt;:U :WORKGROUP:</span><br><span class="line">&lt;00&gt;:G :JOHN‐PC:&lt;20&gt;:U :WORKGROUP:&lt;1e&gt;:G :WORKGROUP:&lt;1d&gt;:U</span><br><span class="line">:__MSBROWSE__ &lt;01&gt;:G :4c:cc:6a:e3:51:27)</span><br><span class="line">[+] Discovered DNS on 192.168.1.1:53 (de778500000100010000000007564552  53494f4e0442494e440000100003c00c0010000300000001001a19737572656c7920796f7</span><br><span class="line">5206d757374206265206a6f6b696e67)</span><br><span class="line">[*] Scanned 43 of 256 hosts (16% complete)</span><br><span class="line">[*] Scanned 52 of 256 hosts (20% complete)</span><br><span class="line">[*] Scanned 89 of 256 hosts (34% complete)</span><br><span class="line">[+] Discovered NetBIOS on 192.168.1.119:137 (WIN03X64:&lt;00&gt;:U :WIN03X64:&lt;20&gt;:U :WORKGROUP:&lt;00&gt;:G :WORKGROUP:&lt;1e&gt;:G :WIN03X64:&lt;03&gt;:U</span><br><span class="line">:ADMINISTRA TOR:&lt;03&gt;:U :WIN03X64:&lt;01&gt;:U :00:0c:29:85:d6:7d)</span><br><span class="line">[*] Scanned 103 of 256 hosts (40% complete)</span><br><span class="line">[*] Scanned 140 of 256 hosts (54% complete)</span><br><span class="line">[*] Scanned 163 of 256 hosts (63% complete)</span><br><span class="line">[*] Scanned 184 of 256 hosts (71% complete)</span><br><span class="line">[*] Scanned 212 of 256 hosts (82% complete)</span><br><span class="line">[*] Scanned 231 of 256 hosts (90% complete)</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x05-auxiliary-scanner-dns-dns-amp"><a href="#0x05-auxiliary-scanner-dns-dns-amp" class="headerlink" title="0x05 auxiliary/scanner/dns/dns_amp"></a>0x05 auxiliary/scanner/dns/dns_amp</h2><p>该模块是基于DNS协议来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/dns/dns_amp) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/dns/dns_amp): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">BATCHSIZE 256 yes The number of hosts to probe in each set</span><br><span class="line">DOMAINNAME isc.org yes Domain to use for the DNS request</span><br><span class="line">FILTER no The filter string for capturing traffic</span><br><span class="line">INTERFACE no The name of the interface</span><br><span class="line">PCAPFILE no The name of the PCAP capture file to process</span><br><span class="line">QUERYTYPE ANY yes Query type(A, NS, SOA, MX, TXT, AAAA, RRSIG, DNSKEY, ANY)</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 53 yes The target port (UDP)</span><br><span class="line">SNAPLEN 65535 yes The number of bytes to capture</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TIMEOUT 500 yes The number of seconds to wait for new data </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/dns/dns_amp) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Sending DNS probes to 192.168.1.0‐&gt;192.168.1.255 (256 hosts)</span><br><span class="line">[*] Sending 67 bytes to each host using the IN ANY isc.org request</span><br><span class="line">[+] 192.168.1.1:53 ‐ Response is 530 bytes [7.91x Amplification]</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x06-auxiliary-scanner-http-http-version"><a href="#0x06-auxiliary-scanner-http-http-version" class="headerlink" title="0x06 auxiliary/scanner/http/http_version"></a>0x06 auxiliary/scanner/http/http_version</h2><p>该模块用于探测内网的HTTP服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/http/http_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/http/http_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">Proxies no A proxy chain of format type:host:port[,type:host:port] [...]</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 80 yes The target port (TCP)</span><br><span class="line">SSL false no Negotiate SSL/TLS for outgoing connections</span><br><span class="line">THREADS 20 yes The number of concurrent threads</span><br><span class="line">VHOST no HTTP server virtual host </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/http/http_version) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 192.168.1.1:80</span><br><span class="line">[*] Scanned 27 of 256 hosts (10% complete)</span><br><span class="line">[*] Scanned 63 of 256 hosts (24% complete)</span><br><span class="line">[*] Scanned 82 of 256 hosts (32% complete)</span><br><span class="line">[*] Scanned 103 of 256 hosts (40% complete)</span><br><span class="line">[+] 192.168.1.119:80 Microsoft‐IIS/6.0 ( Powered by ASP.NET )</span><br><span class="line">[*] Scanned 129 of 256 hosts (50% complete)</span><br><span class="line">[*] Scanned 154 of 256 hosts (60% complete)</span><br><span class="line">[*] Scanned 182 of 256 hosts (71% complete)</span><br><span class="line">[*] Scanned 205 of 256 hosts (80% complete)</span><br><span class="line">[*] Scanned 231 of 256 hosts (90% complete)</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x07-auxiliary-scanner-ftp-ftp-version"><a href="#0x07-auxiliary-scanner-ftp-ftp-version" class="headerlink" title="0x07 auxiliary/scanner/ftp/ftp_version"></a>0x07 auxiliary/scanner/ftp/ftp_version</h2><p>该模块用于探测内网的FTP服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/ftp/ftp_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/ftp/ftp_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">FTPPASS mozilla@example.com no The password for the specified username</span><br><span class="line">FTPUSER anonymous no The username to authenticate as</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 21 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/ftp/ftp_version) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Scanned 51 of 256 hosts (19% complete)</span><br><span class="line">[*] Scanned 52 of 256 hosts (20% complete)</span><br><span class="line">[*] Scanned 100 of 256 hosts (39% complete)</span><br><span class="line">[+] 192.168.1.119:21 ‐ FTP Banner: &apos;220 Microsoft FTP Service\x0d\x0a&apos;</span><br><span class="line">[*] Scanned 103 of 256 hosts (40% complete)</span><br><span class="line">[*] Scanned 133 of 256 hosts (51% complete)</span><br><span class="line">[*] Scanned 183 of 256 hosts (71% complete)</span><br><span class="line">[*] Scanned 197 of 256 hosts (76% complete)</span><br><span class="line">[*] Scanned 229 of 256 hosts (89% complete)</span><br><span class="line">[*] Scanned 231 of 256 hosts (90% complete)</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x08-auxiliary-scanner-smb-smb-version"><a href="#0x08-auxiliary-scanner-smb-smb-version" class="headerlink" title="0x08 auxiliary/scanner/smb/smb_version"></a>0x08 auxiliary/scanner/smb/smb_version</h2><p>该模块用于探测内网的SMB服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/smb/smb_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/smb/smb_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">SMBDomain . no The Windows domain to use for authentication</span><br><span class="line">SMBPass no The password for the specified username</span><br><span class="line">SMBUser no The username to authenticate as</span><br><span class="line">THREADS 20 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/smb/smb_version) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 192.168.1.2:445 ‐ Host is running Windows 7 Ultimate SP1 (build:7601) (name:JOHN‐PC) (workgroup:WORKGROUP )</span><br><span class="line">[*] Scanned 40 of 256 hosts (15% complete)</span><br><span class="line">[*] Scanned 60 of 256 hosts (23% complete)</span><br><span class="line">[*] Scanned 79 of 256 hosts (30% complete)</span><br><span class="line">[+] 192.168.1.119:445 ‐ Host is running Windows 2003 R2 SP2 (build:3790) (name:WIN03X64)</span><br><span class="line">[*] Scanned 103 of 256 hosts (40% complete)</span><br><span class="line">[*] Scanned 128 of 256 hosts (50% complete)</span><br><span class="line">[*] Scanned 154 of 256 hosts (60% complete)</span><br><span class="line">[*] Scanned 181 of 256 hosts (70% complete)</span><br><span class="line">[*] Scanned 206 of 256 hosts (80% complete)</span><br><span class="line">[*] Scanned 231 of 256 hosts (90% complete)</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x09-auxiliary-scanner-ssh-ssh-version"><a href="#0x09-auxiliary-scanner-ssh-ssh-version" class="headerlink" title="0x09 auxiliary/scanner/ssh/ssh_version"></a>0x09 auxiliary/scanner/ssh/ssh_version</h2><p>该模块用于探测内网的SSH服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/ssh/ssh_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/ssh/ssh_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 22 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TIMEOUT 30 yes Timeout for the SSH probe </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/ssh/ssh_version) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 192.168.1.5:22 ‐ SSH server version: SSH‐2.0‐OpenSSH_7.9p1 Debian‐5 ( service.version=7.9p1 openssh.comment=Debian‐5 service.vendor=OpenBSD</span><br><span class="line">service.family=OpenSSH service.product=OpenSSH service.cpe23=cpe:/a:openb</span><br><span class="line">sd:openssh:7.9p1 os.vendor=Debian os.family=Linux os.product=Linux os.cpe</span><br><span class="line">23=cpe:/o:debian:debian_linux:‐ service.protocol=ssh fingerprint_db=ssh.banner )</span><br><span class="line">[*] Scanned 52 of 256 hosts (20% complete)</span><br><span class="line">[*] Scanned 95 of 256 hosts (37% complete)</span><br><span class="line">[*] Scanned 100 of 256 hosts (39% complete)</span><br><span class="line">[*] Scanned 103 of 256 hosts (40% complete)</span><br><span class="line">[*] Scanned 131 of 256 hosts (51% complete)</span><br><span class="line">[*] Scanned 154 of 256 hosts (60% complete)</span><br><span class="line">[*] Scanned 180 of 256 hosts (70% complete)</span><br><span class="line">[*] Scanned 206 of 256 hosts (80% complete)</span><br><span class="line">[*] Scanned 235 of 256 hosts (91% complete)</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x0A-auxiliary-scanner-telnet-telnet-version"><a href="#0x0A-auxiliary-scanner-telnet-telnet-version" class="headerlink" title="0x0A auxiliary/scanner/telnet/telnet_version"></a>0x0A auxiliary/scanner/telnet/telnet_version</h2><p>该模块用于探测内网的TELNET服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/telnet/telnet_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/telnet/telnet_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">PASSWORD no The password for the specified username</span><br><span class="line">RHOSTS 192.168.1.119 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 23 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TIMEOUT 30 yes Timeout for the Telnet probe</span><br><span class="line">USERNAME no The username to authenticate as </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/telnet/telnet_version) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 192.168.1.119:23 ‐ 192.168.1.119:23 TELNET Welcome to Microsoft Telnet Service \x0a\x0a\x0dlogin:</span><br><span class="line">[*] Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x0B-auxiliary-scanner-mysql-mysql-version"><a href="#0x0B-auxiliary-scanner-mysql-mysql-version" class="headerlink" title="0x0B auxiliary/scanner/mysql/mysql_version"></a>0x0B auxiliary/scanner/mysql/mysql_version</h2><p>该模块用于探测内网的MySQL服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/mysql/mysql_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/mysql/mysql_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">RHOSTS 192.168.1.115 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 3306 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/mysql/mysql_version) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 192.168.1.115:3306 ‐ 192.168.1.115:3306 is running MySQL 5.1.52‐community (protocol 10)</span><br><span class="line">[*] Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x0C-auxiliary-scanner-netbios-nbname"><a href="#0x0C-auxiliary-scanner-netbios-nbname" class="headerlink" title="0x0C auxiliary/scanner/netbios/nbname"></a>0x0C auxiliary/scanner/netbios/nbname</h2><p>该模块是基于NetBIOS来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/netbios/nbname) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/netbios/nbname): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">BATCHSIZE 256 yes The number of hosts to probe in each set</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 137 yes The target port (UDP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/netbios/nbname) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Sending NetBIOS requests to 192.168.1.0‐&gt;192.168.1.255 (256 hosts)</span><br><span class="line">[+] 192.168.1.2 [JOHN‐PC] OS:Windows Names:(JOHN‐PC, WORKGROUP, __MSBROWSE__) Addresses:(192.168.1.2, 192.168.163.1, 192.168.32.1)Mac:4c:cc:6a:e3:51:27</span><br><span class="line">[+] 192.168.1.115 [VM_2003X86] OS:Windows Names:(VM_2003X86,WORKGROUP) Addresses:(192.168.1.115) Mac:00:0c:29:af:ce:cc Virtual Machine:VMWare</span><br><span class="line">[+] 192.168.1.119 [WIN03X64] OS:Windows User:ADMINISTRATOR Names:(WIN03X64, WORKGROUP, ADMINISTRATOR) Addresses:(192.168.1.119)Mac:00:0c:29:85:d6:7d Virtual Machine:VMWare</span><br><span class="line">[*] Scanned 256 of 256 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x0D-auxiliary-scanner-http-title"><a href="#0x0D-auxiliary-scanner-http-title" class="headerlink" title="0x0D auxiliary/scanner/http/title"></a>0x0D auxiliary/scanner/http/title</h2><p>该模块用于探测内网的HTTP服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/http/title) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/http/title): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">Proxies no A proxy chain of format type:host:port[,type:host:port] [...]</span><br><span class="line">RHOSTS 192.168.1.115,119 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 80 yes The target port (TCP)</span><br><span class="line">SHOW_TITLES true yes Show the titles on the console as they are grabbed</span><br><span class="line">SSL false no Negotiate SSL/TLS for outgoing connections</span><br><span class="line">STORE_NOTES true yes Store the captured information in notes. Use &quot;no tes‐t http.title&quot; to view</span><br><span class="line">TARGETURI / yes The base path</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/http/title) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] [192.168.1.115:80] [C:200] [R:] [S:Microsoft‐IIS/6.0] 协同管理系统</span><br><span class="line">[*] Scanned 2 of 2 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x0E-auxiliary-scanner-db2-db2-version"><a href="#0x0E-auxiliary-scanner-db2-db2-version" class="headerlink" title="0x0E auxiliary/scanner/db2/db2_version"></a>0x0E auxiliary/scanner/db2/db2_version</h2><p>该模块用于探测内网的db2服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/http/title) &gt; use auxiliary/scanner/db2/db2_version</span><br><span class="line">msf auxiliary(scanner/db2/db2_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/db2/db2_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">DATABASE toolsdb yes The name of the target database</span><br><span class="line">RHOSTS 192.168.1.0/24 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 50000 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TIMEOUT 5 yes Timeout for the DB2 probe </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/db2/db2_version) &gt; exploit</span><br></pre></td></tr></table></figure>
<h2 id="0x0F-auxiliary-scanner-portscan-ack"><a href="#0x0F-auxiliary-scanner-portscan-ack" class="headerlink" title="0x0F auxiliary/scanner/portscan/ack"></a>0x0F auxiliary/scanner/portscan/ack</h2><p>该模块是基于TCP协议的ACK报文扫描端口来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/portscan/ack) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/portscan/ack): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">BATCHSIZE 256 yes The number of hosts to scan per set</span><br><span class="line">DELAY 0 yes The delay between connections, per thread, in milliseconds</span><br><span class="line">INTERFACE no The name of the interface</span><br><span class="line">JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.</span><br><span class="line">PORTS 445 yes Ports to scan (e.g. 22‐25,80,110‐900)</span><br><span class="line">RHOSTS 192.168.1.115,119 yes The target address range or CIDR identifier</span><br><span class="line">SNAPLEN 65535 yes The number of bytes to capture</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TIMEOUT 500 yes The reply read timeout in milliseconds </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/portscan/ack) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] TCP UNFILTERED 192.168.1.115:445</span><br><span class="line">[*] TCP UNFILTERED 192.168.1.119:445</span><br><span class="line">[*] Scanned 2 of 2 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x10-auxiliary-scanner-portscan-tcp"><a href="#0x10-auxiliary-scanner-portscan-tcp" class="headerlink" title="0x10 auxiliary/scanner/portscan/tcp"></a>0x10 auxiliary/scanner/portscan/tcp</h2><p>该模块是基于TCP协议扫描端口来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/portscan/tcp) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/portscan/tcp): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">CONCURRENCY 10 yes The number of concurrent ports to check per host</span><br><span class="line">DELAY 0 yes The delay between connections, per thread, in milliseconds</span><br><span class="line">JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.</span><br><span class="line">PORTS 445 yes Ports to scan (e.g. 22‐25,80,110‐900)</span><br><span class="line">RHOSTS 192.168.1.115,119,2 yes The target address range or CIDR identifier</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TIMEOUT 1000 yes The socket connect timeout in milliseconds</span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/portscan/tcp) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 192.168.1.2: ‐ 192.168.1.2:445 ‐ TCP OPEN</span><br><span class="line">[*] Scanned 1 of 3 hosts (33% complete)</span><br><span class="line">[+] 192.168.1.119: ‐ 192.168.1.119:445 ‐ TCP OPEN</span><br><span class="line">[+] 192.168.1.115: ‐ 192.168.1.115:445 ‐ TCP OPEN</span><br><span class="line">[*] Scanned 3 of 3 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x11-auxiliary-scanner-portscan-syn"><a href="#0x11-auxiliary-scanner-portscan-syn" class="headerlink" title="0x11 auxiliary/scanner/portscan/syn"></a>0x11 auxiliary/scanner/portscan/syn</h2><p>该模块是基于TCP协议的SYN报文扫描端口来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/portscan/syn) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/portscan/syn): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">BATCHSIZE 256 yes The number of hosts to scan per set</span><br><span class="line">DELAY 0 yes The delay between connections, per thread, in millisecond s</span><br><span class="line">INTERFACE no The name of the interface</span><br><span class="line">JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.</span><br><span class="line">PORTS 445 yes Ports to scan (e.g. 22‐25,80,110‐900)</span><br><span class="line">RHOSTS 192.168.1.115 yes The target address range or CIDR identifier</span><br><span class="line">SNAPLEN 65535 yes The number of bytes to capture</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TIMEOUT 500 yes The reply read timeout in milliseconds </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/portscan/syn) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] TCP OPEN 192.168.1.115:445</span><br><span class="line"></span><br><span class="line">[*] Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x12-auxiliary-scanner-portscan-ftpbounce"><a href="#0x12-auxiliary-scanner-portscan-ftpbounce" class="headerlink" title="0x12 auxiliary/scanner/portscan/ftpbounce"></a>0x12 auxiliary/scanner/portscan/ftpbounce</h2><p>该模块是基于FTP Bounce攻击来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/portscan/ftpbounce) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/portscan/ftpbounce): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">BOUNCEHOST 192.168.1.119 yes FTP relay host</span><br><span class="line">BOUNCEPORT 21 yes FTP relay port</span><br><span class="line">DELAY 0 yes The delay between connections, per thread, in millisecond s</span><br><span class="line">FTPPASS mozilla@example.com no The password for the specified usernam e</span><br><span class="line">FTPUSER anonymous no The username to authenticate as</span><br><span class="line">JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.</span><br><span class="line">PORTS 22‐25 yes Ports to scan (e.g. 22‐25,80,110‐900)</span><br><span class="line">RHOSTS 192.168.1.119 yes The target address range or CIDR identifier</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/portscan/ftpbounce) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 192.168.1.119:21 ‐ TCP OPEN 192.168.1.119:22</span><br><span class="line">[+] 192.168.1.119:21 ‐ TCP OPEN 192.168.1.119:23</span><br><span class="line">[+] 192.168.1.119:21 ‐ TCP OPEN 192.168.1.119:24</span><br><span class="line">[+] 192.168.1.119:21 ‐ TCP OPEN 192.168.1.119:25</span><br><span class="line">[*] 192.168.1.119:21 ‐ Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x13-auxiliary-scanner-portscan-xmas"><a href="#0x13-auxiliary-scanner-portscan-xmas" class="headerlink" title="0x13 auxiliary/scanner/portscan/xmas"></a>0x13 auxiliary/scanner/portscan/xmas</h2><p>该模块是基于TCP Xmax扫描来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/portscan/xmas) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/portscan/xmas): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">BATCHSIZE 256 yes The number of hosts to scan per set</span><br><span class="line">DELAY 0 yes The delay between connections, per thread, in millisecond s</span><br><span class="line">INTERFACE no The name of the interface</span><br><span class="line">JITTER 0 yes The delay jitter factor (maximum value by which to +/‐ DELAY) in milliseconds.</span><br><span class="line">PORTS 80 yes Ports to scan (e.g. 22‐25,80,110‐900)</span><br><span class="line">RHOSTS 192.168.1.119 yes The target address range or CIDR identifier</span><br><span class="line">SNAPLEN 65535 yes The number of bytes to capture</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TIMEOUT 500 yes The reply read timeout in milliseconds </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/portscan/xmas) &gt; exploit</span><br></pre></td></tr></table></figure>
<h2 id="0x14-auxiliary-scanner-rdp-rdp-scanner"><a href="#0x14-auxiliary-scanner-rdp-rdp-scanner" class="headerlink" title="0x14 auxiliary/scanner/rdp/rdp_scanner"></a>0x14 auxiliary/scanner/rdp/rdp_scanner</h2><p>该模块是基于RDP服务扫描来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/rdp/rdp_scanner) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/rdp/rdp_scanner): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">CredSSP true yes Whether or not to request CredSSP</span><br><span class="line">EarlyUser false yes Whether to support Earlier User Authorization Result PDU</span><br><span class="line">RHOSTS 192.168.1.2,115,119 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 3389 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">TLS true yes Wheter or not request TLS security </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/rdp/rdp_scanner) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Scanned 1 of 3 hosts (33% complete)</span><br><span class="line">[+] 192.168.1.115:3389 ‐ Identified RDP</span><br><span class="line">[*] Scanned 2 of 3 hosts (66% complete)</span><br><span class="line">[+] 192.168.1.119:3389 ‐ Identified RDP</span><br><span class="line">[*] Scanned 3 of 3 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x15-auxiliary-scanner-smtp-smtp-version"><a href="#0x15-auxiliary-scanner-smtp-smtp-version" class="headerlink" title="0x15 auxiliary/scanner/smtp/smtp_version"></a>0x15 auxiliary/scanner/smtp/smtp_version</h2><p>该模块用于探测内网的SMTP服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/smtp/smtp_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/smtp/smtp_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">RHOSTS 192.168.1.5 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 25 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/smtp/smtp_version) &gt; exploit</span><br></pre></td></tr></table></figure>
<h2 id="0x16-auxiliary-scanner-pop3-pop3-version"><a href="#0x16-auxiliary-scanner-pop3-pop3-version" class="headerlink" title="0x16 auxiliary/scanner/pop3/pop3_version"></a>0x16 auxiliary/scanner/pop3/pop3_version</h2><p>该模块用于探测内网的POP3服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/pop3/pop3_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/pop3/pop3_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">RHOSTS 192.168.1.110‐120 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 110 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/pop3/pop3_version) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] Scanned 5 of 11 hosts (45% complete)</span><br><span class="line">[*] Scanned 11 of 11 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x17-auxiliary-scanner-postgres-postgres-version"><a href="#0x17-auxiliary-scanner-postgres-postgres-version" class="headerlink" title="0x17 auxiliary/scanner/postgres/postgres_version"></a>0x17 auxiliary/scanner/postgres/postgres_version</h2><p>该模块用于探测内网的PostgreSQL服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/postgres/postgres_version) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/postgres/postgres_version): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">DATABASE template1 yes The database to authenticate against</span><br><span class="line">PASSWORD msf no The password for the specified username. Leave blank for a random password.</span><br><span class="line">RHOSTS 127.0.0.1 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 5432 yes The target port</span><br><span class="line">THREADS 50 yes The number of concurrent threads</span><br><span class="line">USERNAME msf yes The username to authenticate as</span><br><span class="line">VERBOSE false no Enable verbose output </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/postgres/postgres_version) &gt; exploit </span><br><span class="line"></span><br><span class="line">[*] 127.0.0.1:5432 Postgres ‐ Version PostgreSQL 9.6.6 on x86_64‐pc‐li</span><br><span class="line">nux‐gnu, compiled by gcc (Debian 4.9.2‐10) 4.9.2, 64‐bit (Post‐Auth)</span><br><span class="line">[*] Scanned 1 of 1 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x18-auxiliary-scanner-ftp-anonymous"><a href="#0x18-auxiliary-scanner-ftp-anonymous" class="headerlink" title="0x18 auxiliary/scanner/ftp/anonymous"></a>0x18 auxiliary/scanner/ftp/anonymous</h2><p>该模块是基于FTP匿名访问来发现内网存活主机。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">msf auxiliary(scanner/ftp/anonymous) &gt; show options </span><br><span class="line"></span><br><span class="line">Module options (auxiliary/scanner/ftp/anonymous): </span><br><span class="line"></span><br><span class="line">Name Current Setting Required Description</span><br><span class="line">‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐‐‐</span><br><span class="line">FTPPASS mozilla@example.com no The password for the specified username</span><br><span class="line">FTPUSER anonymous no The username to authenticate as</span><br><span class="line">RHOSTS 192.168.1.100‐120 yes The target address range or CIDR identifier</span><br><span class="line">RPORT 21 yes The target port (TCP)</span><br><span class="line">THREADS 50 yes The number of concurrent threads </span><br><span class="line"></span><br><span class="line">msf auxiliary(scanner/ftp/anonymous) &gt; exploit </span><br><span class="line"></span><br><span class="line">[+] 192.168.1.115:21 ‐ 192.168.1.115:21 ‐ Anonymous READ (220 Slyar Ftpserver)</span><br><span class="line">[+] 192.168.1.119:21 ‐ 192.168.1.119:21 ‐ Anonymous READ (220 FTPserver)</span><br><span class="line">[*] Scanned 3 of 21 hosts (14% complete)</span><br><span class="line">[*] Scanned 6 of 21 hosts (28% complete)</span><br><span class="line">[*] Scanned 17 of 21 hosts (80% complete)</span><br><span class="line">[*] Scanned 21 of 21 hosts (100% complete)</span><br><span class="line">[*] Auxiliary module execution completed</span><br></pre></td></tr></table></figure>
<h2 id="0x19-db-nmap和hosts内置命令"><a href="#0x19-db-nmap和hosts内置命令" class="headerlink" title="0x19 db_nmap和hosts内置命令"></a>0x19 db_nmap和hosts内置命令</h2><p>MSF内置强大的端口扫描工具Nmap，为了更好的区别，内置命令为：<code>db_nmap</code>，并且会自动存储nmap扫描结果到数据库中，方便快速查询已知存活主机，以及更快捷的进行团队协同作战，使用方法与nmap一致。也是在实战中最常用到的发现内网存活主机方式之一。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; db_nmap ‐p 445 ‐T4 ‐sT 192.168.1.115‐120</span><br><span class="line">‐‐open</span><br><span class="line">[*] Nmap: Starting Nmap 7.70 ( https://nmap.org ) at 2019‐02‐17 15:17 EST</span><br><span class="line">[*] Nmap: Nmap scan report for 192.168.1.115</span><br><span class="line">[*] Nmap: Host is up (0.0025s latency).</span><br><span class="line">[*] Nmap: PORT STATE SERVICE</span><br><span class="line">[*] Nmap: 445/tcp open microsoft‐ds</span><br><span class="line">[*] Nmap: MAC Address: 00:0C:29:AF:CE:CC (VMware)</span><br><span class="line">[*] Nmap: Nmap scan report for 192.168.1.119</span><br><span class="line">[*] Nmap: Host is up (0.0026s latency).</span><br><span class="line">[*] Nmap: PORT STATE SERVICE</span><br><span class="line">[*] Nmap: 445/tcp open microsoft‐ds</span><br><span class="line">[*] Nmap: MAC Address: 00:0C:29:85:D6:7D (VMware)</span><br><span class="line">[*] Nmap: Nmap done: 6 IP addresses (2 hosts up) scanned in 13.35 seconds</span><br></pre></td></tr></table></figure>
<p>运行db_nmap命令如果出现<code>Database not connected</code>错误，退出msfconsole并执行以下命令：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">root@kali:/home/kali<span class="comment"># msfdb init</span></span><br><span class="line">[+] Starting database</span><br><span class="line">[+] Creating database user <span class="string">'msf'</span></span><br><span class="line">[+] Creating databases <span class="string">'msf'</span></span><br><span class="line">[+] Creating databases <span class="string">'msf_test'</span></span><br><span class="line">[+] Creating configuration file <span class="string">'/usr/share/metasploit-framework/config/database.yml'</span></span><br><span class="line">[+] Creating initial database schema</span><br><span class="line">/usr/share/metasploit-framework/vendor/bundle/ruby/2.7.0/gems/activerecord-4.2.11.3/lib/active_record/connection_adapters/abstract_adapter.rb:84: warning: deprecated Object<span class="comment">#=~ is called on Integer; it always returns nil</span></span><br></pre></td></tr></table></figure>
<p>hosts命令可以查看数据库中已发现的内网存活主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; hosts </span><br><span class="line"></span><br><span class="line">Hosts</span><br><span class="line">===== </span><br><span class="line"></span><br><span class="line">address mac name os_name os_flavor os_sp purpose info comments</span><br><span class="line">‐‐‐‐‐‐‐ ‐‐‐ ‐‐‐‐ ‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐ ‐‐‐‐‐‐‐ ‐‐‐‐ ‐‐‐‐‐‐‐‐</span><br><span class="line">1.34.37.188 firewall</span><br><span class="line">10.0.0.2 00:24:1d:dc:3b:16</span><br><span class="line">10.0.0.3 00:e0:81:bf:b9:7b</span><br><span class="line">10.0.0.4 00:30:6e:ca:10:b8</span><br><span class="line">10.0.0.5 9c:8e:99:c4:63:74 2013XXXXX Windows 2008 SP1 client</span><br><span class="line">...</span><br><span class="line">10.0.0.242 00:13:57:01:d4:71</span><br><span class="line">10.0.0.243 00:13:57:01:d4:73</span><br><span class="line">....</span><br><span class="line">10.162.110.30 firewall</span><br><span class="line">59.125.110.178 firewall</span><br><span class="line">127.0.0.1 Unknown device</span><br><span class="line">172.16.204.8 WIN‐6FEAACQJ691 Windows 2012 server</span><br><span class="line">172.16.204.9 WIN‐6FEAACQJ691 Windows 2012 server</span><br><span class="line">172.16.204.21 IDS Windows 2003 SP2 server</span><br><span class="line">192.168.1.5 JOHN‐PC Windows 7 SP1 client</span><br><span class="line">192.168.1.101 JOHN‐PC Windows 7 Ultimate SP1 client</span><br><span class="line">192.168.1.103 LAPTOP‐9994K8RP Windows 10 client</span><br><span class="line">192.168.1.115 00:0c:29:af:ce:cc VM_2003X86 Windows 2003 SP2 server</span><br><span class="line">192.168.1.116 WIN‐S4H51RDJQ3M Windows 2012 server</span><br><span class="line">192.168.1.119 00:0c:29:85:d6:7d WIN03X64 Windows 2003 SP2 server</span><br><span class="line">192.168.1.254 Unknown device</span><br><span class="line">192.168.50.30 WINDOWS‐G4MMTV8 Windows 7 SP1 client</span><br><span class="line">192.168.100.2 Unknown device</span><br><span class="line">192.168.100.10</span><br></pre></td></tr></table></figure>
<p>同样hosts命令也支持数据库中查询与搜索，方便快速对应目标存活主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">msf exploit(multi/handler) &gt; hosts ‐h</span><br><span class="line">Usage: hosts [ options ] [addr1 addr2 ...] </span><br><span class="line"></span><br><span class="line">OPTIONS:</span><br><span class="line">‐a,‐‐add Add the hosts instead of searching</span><br><span class="line">‐d,‐‐delete Delete the hosts instead of searching</span><br><span class="line">‐c &lt;col1,col2&gt; Only show the given columns (see list below)</span><br><span class="line">‐C &lt;col1,col2&gt; Only show the given columns until the next restart (see list below)</span><br><span class="line">‐h,‐‐help Show this help information</span><br><span class="line">‐u,‐‐up Only show hosts which are up</span><br><span class="line">‐o &lt;file&gt; Send output to a file in csv format</span><br><span class="line">‐O &lt;column&gt; Order rows by specified column number</span><br><span class="line">‐R,‐‐rhosts Set RHOSTS from the results of the search</span><br><span class="line">‐S,‐‐search Search string to filter by</span><br><span class="line">‐i,‐‐info Change the info of a host</span><br><span class="line">‐n,‐‐name Change the name of a host</span><br><span class="line">‐m,‐‐comment Change the comment of a host</span><br><span class="line">‐t,‐‐tag Add or specify a tag to a range of hosts</span><br><span class="line"></span><br><span class="line">msf exploit(multi/handler) &gt; hosts ‐S 192 </span><br><span class="line"></span><br><span class="line">Hosts</span><br><span class="line">===== </span><br><span class="line"></span><br><span class="line">address mac name os_name os_flavor os_sp purpose info comments</span><br><span class="line">‐‐‐‐‐‐‐ ‐‐‐ ‐‐‐‐ ‐‐‐‐‐‐‐ ‐‐‐‐‐‐‐‐‐ ‐‐‐‐‐ ‐‐‐‐‐‐‐ ‐‐‐‐ ‐‐‐‐‐‐‐‐</span><br><span class="line">192.168.1.5 JOHN‐PC Windows 7 SP1 client</span><br><span class="line">192.168.1.101 JOHN‐PC Windows 7 Ultimate SP1 client</span><br><span class="line">192.168.1.103 LAPTOP‐9994K8RP Windows 10 client</span><br><span class="line">192.168.1.115 00:0c:29:af:ce:cc VM_2003X86 Windows 2003 SP2 server</span><br><span class="line">192.168.1.116 WIN‐S4H51RDJQ3M Windows 2012 server</span><br><span class="line">192.168.1.119 00:0c:29:85:d6:7d WIN03X64 Windows 2003 SP2 server</span><br><span class="line">192.168.1.254 Unknown device</span><br><span class="line">192.168.50.30 WINDOWS‐G4MMTV8 Windows 7 SP1 client</span><br><span class="line">192.168.100.2 Unknown device</span><br><span class="line">192.168.100.10</span><br></pre></td></tr></table></figure>
<h2 id="0x1A-post-windows-gather-arp-scanner"><a href="#0x1A-post-windows-gather-arp-scanner" class="headerlink" title="0x1A post/windows/gather/arp_scanner"></a>0x1A post/windows/gather/arp_scanner</h2><p>在实战中，许多特殊环境下scanner模块、db_nmap内置命令等均不能快速符合实战渗透诉求，尤其在域中的主机存活发现，而post下的模块弥补了该诉求，以便快速了解域中存活主机。</p>
<p>该后渗透模块用于探测域内存活主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run windows/gather/arp_scanner RHOSTS=192.168.1.110‐120 THREADS=20</span><br><span class="line"></span><br><span class="line">[*] Running module against VM_2003X86</span><br><span class="line">[*] ARP Scanning 192.168.1.110‐120</span><br><span class="line">[+] IP: 192.168.1.115 MAC 00:0c:29:af:ce:cc (VMware, Inc.)</span><br><span class="line">[+] IP: 192.168.1.119 MAC 00:0c:29:85:d6:7d (VMware, Inc.)</span><br></pre></td></tr></table></figure>
<h2 id="0x1B-post-windows-gather-enum-ad-computers"><a href="#0x1B-post-windows-gather-enum-ad-computers" class="headerlink" title="0x1B post/windows/gather/enum_ad_computers"></a>0x1B post/windows/gather/enum_ad_computers</h2><p>该后渗透模块用于探测域内存活主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run windows/gather/enum_ad_computers</span><br></pre></td></tr></table></figure>
<h2 id="0x1C-post-windows-gather-enum-computers"><a href="#0x1C-post-windows-gather-enum-computers" class="headerlink" title="0x1C post/windows/gather/enum_computers"></a>0x1C post/windows/gather/enum_computers</h2><p>该后渗透模块用于探测域内存活主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run windows/gather/enum_computers </span><br><span class="line"></span><br><span class="line">[*] Running module against VM_2003X86</span><br><span class="line">[‐] This host is not part of a domain.</span><br></pre></td></tr></table></figure>
<h2 id="0x1D-post-windows-gather-enum-domain"><a href="#0x1D-post-windows-gather-enum-domain" class="headerlink" title="0x1D post/windows/gather/enum_domain"></a>0x1D post/windows/gather/enum_domain</h2><p>该后渗透模块用于探测域内存活主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run windows/gather/enum_domain</span><br></pre></td></tr></table></figure>
<h2 id="0x1E-post-windows-gather-enum-domains"><a href="#0x1E-post-windows-gather-enum-domains" class="headerlink" title="0x1E post/windows/gather/enum_domains"></a>0x1E post/windows/gather/enum_domains</h2><p>该后渗透模块用于探测域内存活主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run windows/gather/enum_domains </span><br><span class="line"></span><br><span class="line">[*] Enumerating DCs for WORKGROUP</span><br><span class="line">[‐] No Domain Controllers found...</span><br></pre></td></tr></table></figure>
<h2 id="0x1F-post-windows-gather-enum-ad-user-comments"><a href="#0x1F-post-windows-gather-enum-ad-user-comments" class="headerlink" title="0x1F post/windows/gather/enum_ad_user_comments"></a>0x1F post/windows/gather/enum_ad_user_comments</h2><p>该后渗透模块用于探测域内存活主机：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">meterpreter &gt; run windows/gather/enum_ad_user_comments</span><br></pre></td></tr></table></figure>
<h2 id="0x20-其他post下的模块"><a href="#0x20-其他post下的模块" class="headerlink" title="0x20 其他post下的模块"></a>0x20 其他post下的模块</h2><p>列举如下：</p>
<ul>
<li>linux/gather/enum_network</li>
<li>linux/busybox/enum_hosts</li>
<li>windows/gather/enum_ad_users</li>
<li>windows/gather/enum_domain_tokens</li>
<li>windows/gather/enum_snmp</li>
</ul>

    </div>

  </article>
  <div class="toc-container">
    
  <div id="toc" class="toc-article">
    <strong class="toc-title">目录</strong>
    <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#0x00-前言"><span class="toc-text">0x00 前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x01-search支持type类型搜索"><span class="toc-text">0x01 search支持type类型搜索</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x02-auxiliary-scanner-discovery-arp-sweep"><span class="toc-text">0x02 auxiliary/scanner/discovery/arp_sweep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x03-auxiliary-scanner-discovery-udp-sweep"><span class="toc-text">0x03 auxiliary/scanner/discovery/udp_sweep</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x04-auxiliary-scanner-discovery-udp-probe"><span class="toc-text">0x04 auxiliary/scanner/discovery/udp_probe</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x05-auxiliary-scanner-dns-dns-amp"><span class="toc-text">0x05 auxiliary/scanner/dns/dns_amp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x06-auxiliary-scanner-http-http-version"><span class="toc-text">0x06 auxiliary/scanner/http/http_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x07-auxiliary-scanner-ftp-ftp-version"><span class="toc-text">0x07 auxiliary/scanner/ftp/ftp_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x08-auxiliary-scanner-smb-smb-version"><span class="toc-text">0x08 auxiliary/scanner/smb/smb_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x09-auxiliary-scanner-ssh-ssh-version"><span class="toc-text">0x09 auxiliary/scanner/ssh/ssh_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0A-auxiliary-scanner-telnet-telnet-version"><span class="toc-text">0x0A auxiliary/scanner/telnet/telnet_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0B-auxiliary-scanner-mysql-mysql-version"><span class="toc-text">0x0B auxiliary/scanner/mysql/mysql_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0C-auxiliary-scanner-netbios-nbname"><span class="toc-text">0x0C auxiliary/scanner/netbios/nbname</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0D-auxiliary-scanner-http-title"><span class="toc-text">0x0D auxiliary/scanner/http/title</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0E-auxiliary-scanner-db2-db2-version"><span class="toc-text">0x0E auxiliary/scanner/db2/db2_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x0F-auxiliary-scanner-portscan-ack"><span class="toc-text">0x0F auxiliary/scanner/portscan/ack</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x10-auxiliary-scanner-portscan-tcp"><span class="toc-text">0x10 auxiliary/scanner/portscan/tcp</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x11-auxiliary-scanner-portscan-syn"><span class="toc-text">0x11 auxiliary/scanner/portscan/syn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x12-auxiliary-scanner-portscan-ftpbounce"><span class="toc-text">0x12 auxiliary/scanner/portscan/ftpbounce</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x13-auxiliary-scanner-portscan-xmas"><span class="toc-text">0x13 auxiliary/scanner/portscan/xmas</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x14-auxiliary-scanner-rdp-rdp-scanner"><span class="toc-text">0x14 auxiliary/scanner/rdp/rdp_scanner</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x15-auxiliary-scanner-smtp-smtp-version"><span class="toc-text">0x15 auxiliary/scanner/smtp/smtp_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x16-auxiliary-scanner-pop3-pop3-version"><span class="toc-text">0x16 auxiliary/scanner/pop3/pop3_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x17-auxiliary-scanner-postgres-postgres-version"><span class="toc-text">0x17 auxiliary/scanner/postgres/postgres_version</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x18-auxiliary-scanner-ftp-anonymous"><span class="toc-text">0x18 auxiliary/scanner/ftp/anonymous</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x19-db-nmap和hosts内置命令"><span class="toc-text">0x19 db_nmap和hosts内置命令</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1A-post-windows-gather-arp-scanner"><span class="toc-text">0x1A post/windows/gather/arp_scanner</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1B-post-windows-gather-enum-ad-computers"><span class="toc-text">0x1B post/windows/gather/enum_ad_computers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1C-post-windows-gather-enum-computers"><span class="toc-text">0x1C post/windows/gather/enum_computers</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1D-post-windows-gather-enum-domain"><span class="toc-text">0x1D post/windows/gather/enum_domain</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1E-post-windows-gather-enum-domains"><span class="toc-text">0x1E post/windows/gather/enum_domains</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x1F-post-windows-gather-enum-ad-user-comments"><span class="toc-text">0x1F post/windows/gather/enum_ad_user_comments</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#0x20-其他post下的模块"><span class="toc-text">0x20 其他post下的模块</span></a></li></ol>
  </div>


  </div>
</div>
<div class="copyright">
    <span>本作品采用</span>
    <a href="https://creativecommons.org/licenses/by/4.0/">知识共享署名 4.0 国际许可协议</a>
    <span>进行许可。 转载时请注明原文链接。</span>
</div>


  
    <div class="post-nav">
      <div class="post-nav-item post-nav-next">
        
          <span>〈 </span>
          <a href="/2021/02/24/BloodHound、Pupy和GreatSCT工具笔记/" rel="next" title="BloodHound、Pupy和GreatSCT工具笔记">
          BloodHound、Pupy和GreatSCT工具笔记
          </a>
        
      </div>
  
      <div class="post-nav-item post-nav-prev">
          
          <a href="/2021/02/24/DIRB工具笔记/" rel="prev" title="DIRB工具笔记">
            DIRB工具笔记
          </a>
          <span>〉</span>
        
      </div>
    </div>
  


    </div>

    
    

  </div>
  <footer class="footer text-center">
    <div id="bottom-inner">
        <span>Copyright &copy; Mi1k7ea</span>  |  
        <span id="busuanzi_container_site_pv">总访问量 <span id="busuanzi_value_site_pv"></span></span> | 
        <span id="busuanzi_container_site_uv">访客 <span id="busuanzi_value_site_uv"></span></span>
    </div>
</footer>

  

<script>
  (function(window, document, undefined) {

    var timer = null;

    function returnTop() {
      cancelAnimationFrame(timer);
      timer = requestAnimationFrame(function fn() {
        var oTop = document.body.scrollTop || document.documentElement.scrollTop;
        if (oTop > 0) {
          document.body.scrollTop = document.documentElement.scrollTop = oTop - 50;
          timer = requestAnimationFrame(fn);
        } else {
          cancelAnimationFrame(timer);
        }
      });
    }

    var hearts = [];
    window.requestAnimationFrame = (function() {
      return window.requestAnimationFrame ||
        window.webkitRequestAnimationFrame ||
        window.mozRequestAnimationFrame ||
        window.oRequestAnimationFrame ||
        window.msRequestAnimationFrame ||
        function(callback) {
          setTimeout(callback, 1000 / 60);
        }
    })();
    init();

    function init() {
      css(".heart{z-index:9999;width: 10px;height: 10px;position: fixed;background: #f00;transform: rotate(45deg);-webkit-transform: rotate(45deg);-moz-transform: rotate(45deg);}.heart:after,.heart:before{content: '';width: inherit;height: inherit;background: inherit;border-radius: 50%;-webkit-border-radius: 50%;-moz-border-radius: 50%;position: absolute;}.heart:after{top: -5px;}.heart:before{left: -5px;}");
      attachEvent();
      gameloop();
      addMenuEvent();
    }

    function gameloop() {
      for (var i = 0; i < hearts.length; i++) {
        if (hearts[i].alpha <= 0) {
          document.body.removeChild(hearts[i].el);
          hearts.splice(i, 1);
          continue;
        }
        hearts[i].y--;
        hearts[i].scale += 0.004;
        hearts[i].alpha -= 0.013;
        hearts[i].el.style.cssText = "left:" + hearts[i].x + "px;top:" + hearts[i].y + "px;opacity:" + hearts[i].alpha + ";transform:scale(" + hearts[i].scale + "," + hearts[i].scale + ") rotate(45deg);background:" + hearts[i].color;
      }
      requestAnimationFrame(gameloop);
    }

    /**
     * 给logo设置点击事件
     * 
     * - 回到顶部
     * - 出现爱心
     */
    function attachEvent() {
      var old = typeof window.onclick === "function" && window.onclick;
      var logo = document.getElementById("logo");
      if (logo) {
        logo.onclick = function(event) {
          returnTop();
          old && old();
          createHeart(event);
        }
      }
      
    }

    function createHeart(event) {
      var d = document.createElement("div");
      d.className = "heart";
      hearts.push({
        el: d,
        x: event.clientX - 5,
        y: event.clientY - 5,
        scale: 1,
        alpha: 1,
        color: randomColor()
      });
      document.body.appendChild(d);
    }

    function css(css) {
      var style = document.createElement("style");
      style.type = "text/css";
      try {
        style.appendChild(document.createTextNode(css));
      } catch (ex) {
        style.styleSheet.cssText = css;
      }
      document.getElementsByTagName('head')[0].appendChild(style);
    }

    function randomColor() {
      // return "rgb(" + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + "," + (~~(Math.random() * 255)) + ")";
      return "#F44336";
    }

    function addMenuEvent() {
      var menu = document.getElementById('menu-main-post');
      if (menu) {
        var toc = document.getElementById('toc');
        if (toc) {
          menu.onclick = function() {
            if (toc) {
              if (toc.style.display == 'block') {
                toc.style.display = 'none';
              } else {
                toc.style.display = 'block';
              }
            }
          };
        } else {
          menu.style.display = 'none';
        }
      }
    }

  })(window, document);
</script>

  



  
<script>
  (function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
</script>


</body>
</html>
